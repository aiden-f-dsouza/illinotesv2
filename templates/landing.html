<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Prevent flash of wrong theme - must be first -->
    <script>
        (function () {
            var theme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="UIUC Knowledge Collective - Stop searching through endless GroupMe threads. Share, search, and organize class notes by course.">
    <title>Illinotes</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:wght@400;700&display=swap"
        rel="stylesheet">

    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="{{ url_for('static', filename='turbolearn-darkmode.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='landing-page.css') }}">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180"
        href="{{ url_for('static', filename='favicons/apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32"
        href="{{ url_for('static', filename='favicons/favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16"
        href="{{ url_for('static', filename='favicons/favicon-16x16.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='favicons/site.webmanifest') }}">
</head>

<body>
    <!-- Navigation Bar - Minimal Left Overlay -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="/landing">illinotes</a>
            </div>

            <div class="nav-links">
                <a href="/blog">Blog</a>
                <a href="/forum">Forum</a>
                <div class="nav-dropdown">
                    <a href="#" class="dropdown-trigger">
                        About
                        <i class="ph ph-caret-down"></i>
                    </a>
                    <div class="dropdown-menu">
                        <a href="/philosophy">Philosophy</a>
                        <a href="/team">Team</a>
                    </div>
                </div>
            </div>

            <!-- Hamburger Button (Mobile) -->
            <button class="hamburger-btn" aria-label="Open menu">
                <div class="hamburger-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay"></div>

    <!-- Mobile Menu -->
    <div class="mobile-menu">
        <ul class="mobile-menu-links">
            <li><a href="/notes"><i class="ph ph-notebook"></i> Notes Feed</a></li>
            <li><a href="/blog"><i class="ph ph-article"></i> Blog</a></li>
            <li><a href="/forum"><i class="ph ph-chat-circle"></i> Forum</a></li>
            <div class="mobile-menu-divider"></div>
            <li><a href="/philosophy"><i class="ph ph-lightbulb"></i> Philosophy</a></li>
            <li><a href="/team"><i class="ph ph-users"></i> Team</a></li>
            <li><a href="/summarizer"><i class="ph ph-sparkle"></i> AI Summarizer</a></li>
            <div class="mobile-menu-divider"></div>
            <li><a href="/login"><i class="ph ph-sign-in"></i> Login</a></li>
            <li><a href="/signup"><i class="ph ph-user-plus"></i> Sign Up</a></li>
        </ul>

        <!-- Theme Toggle -->
        <div class="mobile-theme-toggle">
            <span><i class="ph ph-moon"></i> Dark Mode</span>
            <div class="theme-switch"></div>
        </div>

        <div class="mobile-menu-cta">
            <a href="/notes" class="cta-button">Start Sharing Notes</a>
        </div>
    </div>

    <!-- Sticky CTA Button (appears on scroll) -->
    <div class="sticky-cta" id="stickyCta">
        <a href="/notes" class="cta-button">Start Sharing Notes</a>
    </div>



    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <h1>A Better Way to Share Notes</h1>
            <p>
                Stop searching through endless GroupMe threads. Illinotes is a centralized platform
                where students tap into the vast knoweldge of their peers by posting, searching, and organizing class
                notes by course.
            </p>
            <a href="/notes" class="cta-button">Start Sharing Notes</a>
        </div>

        <!-- Demo Video - Now inside hero section -->
        <div class="video-container">
            <video class="demo-video" muted autoplay loop controls>
                <source src="{{ url_for('static', filename='demo-video.mp4') }}" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
    </section>

    <!-- Feature Carousel Section -->
    <section class="features-carousel-section">
        <div class="carousel-wrapper">
            <button class="carousel-btn carousel-btn--prev" aria-label="Previous">
                <i class="ph ph-caret-left"></i>
            </button>
            <div class="carousel-track" id="featureCarousel">
                <div class="carousel-card">
                    <i class="ph ph-note-pencil carousel-icon"></i>
                    <h3 class="carousel-card-title">Share Your Notes</h3>
                    <p class="carousel-card-desc">Upload notes organized by UIUC course. Filter by class, search by
                        keyword, and make your study material accessible to classmates.</p>
                </div>
                <div class="carousel-card">
                    <i class="ph ph-sparkle carousel-icon"></i>
                    <h3 class="carousel-card-title">AI Note Summarizer</h3>
                    <p class="carousel-card-desc">Paste or upload your lecture notes and get a clean, concise
                        AI-generated summary in seconds.</p>
                </div>
                <div class="carousel-card">
                    <i class="ph ph-robot carousel-icon"></i>
                    <h3 class="carousel-card-title">AI Tutor Chat</h3>
                    <p class="carousel-card-desc">Every note has a built-in AI tutor. Ask questions in context and get
                        explanations tied directly to the note's content and attachments.</p>
                </div>
                <div class="carousel-card">
                    <i class="ph ph-chat-circle carousel-icon"></i>
                    <h3 class="carousel-card-title">Comments &amp; @Mentions</h3>
                    <p class="carousel-card-desc">Discuss notes with classmates, ask follow-up questions, and tag
                        specific people with @mentions.</p>
                </div>
                <div class="carousel-card">
                    <i class="ph ph-house carousel-icon"></i>
                    <h3 class="carousel-card-title">Built for UIUC</h3>
                    <p class="carousel-card-desc">Organized around UIUC's full course catalog — designed for how
                        Illinois students actually study.</p>
                </div>
                <div class="carousel-card">
                    <i class="ph ph-heart carousel-icon"></i>
                    <h3 class="carousel-card-title">Completely Free</h3>
                    <p class="carousel-card-desc">No paywalls, no premium tiers. Unlimited notes, unlimited access,
                        forever.</p>
                </div>
                <div class="carousel-card">
                    <i class="ph ph-lightning carousel-icon"></i>
                    <h3 class="carousel-card-title">Real-Time Updates</h3>
                    <p class="carousel-card-desc">See new notes from classmates instantly. Stay in sync with your course
                        community.</p>
                </div>
            </div>
            <button class="carousel-btn carousel-btn--next" aria-label="Next">
                <i class="ph ph-caret-right"></i>
            </button>
        </div>
        <div class="carousel-dots" id="carouselDots"></div>
    </section>

    <!-- Comparison Table Section -->
    <section class="comparison-section">
        <h2 class="section-heading">Why Illinotes Wins</h2>
        <div class="table-wrapper">
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>FEATURE</th>
                        <th>GROUPCHAT</th>
                        <th>GROUPME</th>
                        <th>QUIZLET</th>
                        <th>CHEGG</th>
                        <th class="highlight-col">ILLINOTES</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Organized Notes</td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td class="highlight-col"><i class="ph ph-check-square icon-yes"></i></td>
                    </tr>
                    <tr>
                        <td>UIUC-Specific</td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td class="highlight-col"><i class="ph ph-check-square icon-yes"></i></td>
                    </tr>
                    <tr>
                        <td>Searchable</td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td class="highlight-col"><i class="ph ph-check-square icon-yes"></i></td>
                    </tr>
                    <tr>
                        <td>Community-Driven</td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td class="highlight-col"><i class="ph ph-check-square icon-yes"></i></td>
                    </tr>
                    <tr>
                        <td>Free Forever</td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td class="highlight-col"><i class="ph ph-check-square icon-yes"></i></td>
                    </tr>
                    <tr>
                        <td>AI-Powered</td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-x-square icon-no"></i></td>
                        <td><i class="ph ph-check-square icon-yes"></i></td>
                        <td class="highlight-col"><i class="ph ph-check-square icon-yes"></i></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>


    <!-- Live Notes Feed Section -->
    <section class="live-feed-section">
        <h2 class="section-heading">Recent Notes from the Community</h2>
        <div id="live-notes-container" class="notes-grid">
            <!-- Notes will be loaded dynamically -->
            <div class="loading-state">Loading recent notes...</div>
        </div>
        <div class="feed-cta">
            <a href="/notes" class="cta-button">View All Notes</a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <div class="footer-logo">illinotes</div>
            </div>

            <div class="footer-column">
                <h4 class="footer-title">Product</h4>
                <ul class="footer-links">
                    <li><a href="/notes">Notes Feed</a></li>
                    <li><a href="/summarizer">AI Tutor</a></li>
                    <li><a href="/blog">Blog</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h4 class="footer-title">Resources</h4>
                <ul class="footer-links">
                    <li><a href="/philosophy">Philosophy</a></li>
                    <li><a href="/team">Team</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h4 class="footer-title">Support</h4>
                <ul class="footer-links">
                    <li><a href="/support">Help & Support</a></li>
                    <li><a href="/support">Contact</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-disclaimer">
            <i class="ph ph-shield-warning"></i>
            <p>Illinotes is for sharing study notes and educational resources only. Please do not upload exam answers,
                solutions to graded assignments, or any material that violates your institution's academic integrity
                policy.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // About dropdown functionality
            const aboutDropdown = document.querySelector('.nav-dropdown');
            if (aboutDropdown) {
                const aboutTrigger = aboutDropdown.querySelector('.dropdown-trigger');
                const aboutMenu = aboutDropdown.querySelector('.dropdown-menu');

                aboutTrigger.addEventListener('click', function (e) {
                    e.preventDefault();
                    aboutMenu.classList.toggle('active');
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', function (e) {
                    if (!aboutDropdown.contains(e.target)) {
                        aboutMenu.classList.remove('active');
                    }
                });
            }

            // Sticky CTA button on scroll
            const stickyCta = document.getElementById('stickyCta');
            let heroCtaPosition = null;

            // Calculate hero CTA button position after page load
            setTimeout(() => {
                const heroCtaButton = document.querySelector('.hero-content .cta-button');
                if (heroCtaButton) {
                    // Get the bottom edge of the hero CTA button
                    const rect = heroCtaButton.getBoundingClientRect();
                    heroCtaPosition = rect.bottom + window.scrollY;
                }
            }, 100);

            // Show/hide sticky CTA based on scroll position
            window.addEventListener('scroll', function () {
                if (heroCtaPosition && window.scrollY > heroCtaPosition) {
                    stickyCta.classList.add('visible');
                } else {
                    stickyCta.classList.remove('visible');
                }
            });

            // Load live notes feed
            loadRecentNotes();
        });

        async function loadRecentNotes() {
            const container = document.getElementById('live-notes-container');

            try {
                const response = await fetch('/api/landing/recent-notes');
                const data = await response.json();

                if (data.notes && data.notes.length > 0) {
                    container.innerHTML = data.notes.map(note => `
                        <div class="note-card">
                            <div class="note-header">
                                <span class="note-class">${note.class_code}</span>
                                <span class="note-date">${formatDate(note.created)}</span>
                            </div>
                            <h3 class="note-title">${escapeHtml(note.title)}</h3>
                            <p class="note-author">by ${escapeHtml(note.author)}</p>
                            <p class="note-preview">${escapeHtml(note.body.substring(0, 150))}...</p>
                            <div class="note-footer">
                                <span class="note-stat">
                                    <i class="ph ph-heart"></i> ${note.likes_count}
                                </span>
                                <span class="note-stat">
                                    <i class="ph ph-chat-circle"></i> ${note.comments_count}
                                </span>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="no-notes">No notes shared yet. Be the first!</p>';
                }
            } catch (error) {
                console.error('Error loading notes:', error);
                container.innerHTML = '<p class="error-state">Unable to load recent notes.</p>';
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;

            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Table scroll affordance
        const tableWrapper = document.querySelector('.table-wrapper');
        if (tableWrapper) {
            tableWrapper.addEventListener('scroll', function () {
                const isScrolledToEnd = this.scrollLeft + this.clientWidth >= this.scrollWidth - 10;
                this.classList.toggle('scrolled-end', isScrolledToEnd);
            });
        }

        // Feature Carousel — infinite loop + auto-scroll
        (function () {
            var track = document.getElementById('featureCarousel');
            var dotsContainer = document.getElementById('carouselDots');
            var prevBtn = document.querySelector('.carousel-btn--prev');
            var nextBtn = document.querySelector('.carousel-btn--next');
            if (!track || !dotsContainer) return;

            var originals = Array.from(track.querySelectorAll('.carousel-card'));
            var N = originals.length;
            if (N === 0) return;

            // Append clones so the track seamlessly loops
            originals.forEach(function (card) {
                var clone = card.cloneNode(true);
                clone.setAttribute('aria-hidden', 'true');
                track.appendChild(clone);
            });

            // Build dots (one per original card only)
            for (var i = 0; i < N; i++) {
                var dot = document.createElement('button');
                dot.className = 'carousel-dot' + (i === 0 ? ' active' : '');
                dot.setAttribute('aria-label', 'Go to slide ' + (i + 1));
                dotsContainer.appendChild(dot);
            }
            var dots = Array.from(dotsContainer.querySelectorAll('.carousel-dot'));

            // Buttons always enabled — infinite loop has no end
            if (prevBtn) prevBtn.disabled = false;
            if (nextBtn) nextBtn.disabled = false;

            // Cache card width; invalidate on resize
            var _cw = 0;
            function cw() {
                if (_cw) return _cw;
                var gap = parseInt(getComputedStyle(track).gap) || 24;
                _cw = (originals[0] ? originals[0].offsetWidth : 380) + gap;
                return _cw;
            }
            window.addEventListener('resize', function () { _cw = 0; });

            // Update active dot from current scrollLeft
            function updateDots() {
                var cardW = cw();
                var idx = (Math.round(track.scrollLeft / cardW) % N + N) % N;
                dots.forEach(function (d, i) { d.classList.toggle('active', i === idx); });
            }

            // Custom smooth scroll (JS-driven, ignores CSS scroll-behavior)
            var _animating = false;
            function smoothScrollTo(target, duration, cb) {
                var start = track.scrollLeft;
                var dist = target - start;
                var t0 = performance.now();
                _animating = true;
                function frame(now) {
                    var elapsed = now - t0;
                    var p = Math.min(elapsed / duration, 1);
                    // ease-in-out cubic
                    var ease = p < 0.5 ? 4 * p * p * p : 1 - Math.pow(-2 * p + 2, 3) / 2;
                    track.scrollLeft = start + dist * ease;
                    if (p < 1) {
                        requestAnimationFrame(frame);
                    } else {
                        track.scrollLeft = target;
                        _animating = false;
                        if (cb) cb();
                    }
                }
                requestAnimationFrame(frame);
            }

            // Auto-scroll state
            var SPEED = 0.5; // px per animation frame (~30 px/s at 60 fps)
            var _paused = false;
            var _pauseTimer;

            function pauseFor(ms) {
                _paused = true;
                clearTimeout(_pauseTimer);
                if (ms > 0) _pauseTimer = setTimeout(function () { _paused = false; }, ms);
            }
            function unpause() { _paused = false; }

            // rAF loop
            function tick() {
                if (!_paused && !_animating) {
                    track.scrollLeft += SPEED;
                    // Seamless loop: jump back when we've consumed all originals
                    if (track.scrollLeft >= N * cw()) {
                        track.scrollLeft -= N * cw();
                    }
                }
                updateDots();
                requestAnimationFrame(tick);
            }

            // Pause on hover/touch so users can read cards
            track.addEventListener('mouseenter', function () { pauseFor(0); });
            track.addEventListener('mouseleave', unpause);
            track.addEventListener('touchstart', function () { pauseFor(0); }, { passive: true });
            track.addEventListener('touchend', function () { pauseFor(3000); }, { passive: true });

            // Prev button
            if (prevBtn) {
                prevBtn.addEventListener('click', function () {
                    if (_animating) return;
                    pauseFor(5000);
                    var cardW = cw();
                    // If near the start, teleport to equivalent position in clone region first
                    if (track.scrollLeft < cardW) {
                        track.scrollLeft += N * cardW;
                    }
                    var target = Math.round(track.scrollLeft / cardW - 1) * cardW;
                    smoothScrollTo(Math.max(0, target), 450);
                });
            }

            // Next button
            if (nextBtn) {
                nextBtn.addEventListener('click', function () {
                    if (_animating) return;
                    pauseFor(5000);
                    var cardW = cw();
                    var target = Math.round(track.scrollLeft / cardW + 1) * cardW;
                    smoothScrollTo(target, 450, function () {
                        // If we landed in the clone region, silently jump back
                        if (track.scrollLeft >= N * cardW) {
                            track.scrollLeft -= N * cardW;
                        }
                    });
                });
            }

            // Dot clicks
            dots.forEach(function (dot, i) {
                dot.addEventListener('click', function () {
                    if (_animating) return;
                    pauseFor(5000);
                    smoothScrollTo(i * cw(), 450);
                });
            });

            // Kick off the loop
            requestAnimationFrame(tick);
        })();
    </script>
    <script src="{{ url_for('static', filename='mobile-menu.js') }}"></script>
</body>

</html>